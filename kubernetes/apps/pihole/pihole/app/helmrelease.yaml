---
# yaml-language-server: $schema=https://raw.githubusercontent.com/fluxcd-community/flux2-schemas/main/helmrelease-helm-v2.json
apiVersion: helm.toolkit.fluxcd.io/v2
kind: HelmRelease
metadata:
  name: pihole
  namespace: pihole
spec:
  interval: 30m
  chart:
    spec:
      chart: pihole
      version: "2.34.0"
      sourceRef:
        kind: HelmRepository
        name: mojo2600
        namespace: flux-system
  values:
    # Basic settings
    timezone: "Europe/Athens"

    # Admin password
    adminPassword: "changeme123"

    # DNS settings
    DNS1: "1.1.1.1"
    DNS2: "1.0.0.1"

    # Persistence
    persistentVolumeClaim:
      enabled: true
      size: "1Gi"

    # Web service (ClusterIP for now)
    serviceWeb:
      type: ClusterIP
      port: 80

    # DNS service with LoadBalancer
    serviceDns:
      type: LoadBalancer
      externalTrafficPolicy: Local
      loadBalancerIP: "192.168.31.244"
      annotations:
        io.cilium/lb-ipam-ips: "192.168.31.244"
